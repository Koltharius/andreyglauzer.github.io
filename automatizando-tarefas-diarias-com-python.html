
<!DOCTYPE html>
<html>
  <head>
	<!-- Meta -->
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
	<meta name="generator" content="Jekyll">

	<title>Automatizando tarefas diarias com python | Andrey Glauzer | Analista de Suporte / Analista de Segurança da Informação em Barueri/SP</title>
	<link rel="stylesheet"  href="/css/font-awesome/css/font-awesome.min.css">

	<!-- CSS & fonts -->
	<link rel="stylesheet" href="/css/main.css">
	<link href="//fonts.googleapis.com/css?family=Suez+One|Ubuntu:300,400,500,700" rel="stylesheet" data-n-head="true">

	<!-- RSS -->
	<link href="/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" />

	<!-- Icons -->

	<link rel="apple-touch-icon" sizes="57x57" href="/img/logo/apple-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/img/logo/apple-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/img/logo/apple-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/img/logo/apple-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/img/logo/apple-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/img/logo/apple-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/img/logo/apple-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/img/logo/apple-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/img/logo/apple-icon-180x180.png">
	<link rel="icon" type="image/png" sizes="192x192"  href="/img/logo/android-icon-192x192.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/img/logo/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="96x96" href="/img/logo/favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/img/logo/favicon-16x16.png">
	<link rel="manifest" href="/img/logo/manifest.json">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="/img/logo/ms-icon-144x144.png">
	<meta name="theme-color" content="#ffffff">

	<!-- Meta tags -->
	<meta data-n-head="true" charset="utf-8">
   	<meta data-n-head="true" content="IE=edge" http-equiv="X-UA-Compatible">
   	<meta data-n-head="true" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=5,user-scalable=yes" name="viewport">
	<meta data-n-head="true" content="pt_BR" name="og:locale">
	<meta data-n-head="true" content="index,follow" name="googlebot">
	<meta data-n-head="true" content="index,follow,noodp" name="robots">
	<meta data-n-head="true" content="#006fb6" name="theme-color">
	<meta data-n-head="true" content="summary_large_image" name="twitter:card">
	<meta data-n-head="true" content="@nglauzer" name="twitter:site">
	<meta data-n-head="true" content="Brazil" name="country">
	<meta data-n-head="true" content="7 days" name="revisit-after">
	<meta data-n-head="true" content="yes" name="mobile-web-app-capable">
	<meta data-n-head="true" content="Andrey Glauzer | Analista de Suporte / Analista de Segurança da Informação em Barueri/SP" name="application-name">
	<meta data-n-head="true" content="Visual Studio Code v1.17" name="generator">
	<meta data-n-head="true" content="/browserconfig.xml" name="msapplication-config">
	<meta data-n-head="true" content="profile" data-hid="og:type" property="og:type">
	<meta data-n-head="true" content="Andrey Glauzer | Analista de Suporte / Analista de Segurança da Informação em Barueri/SP" data-hid="og:title" property="og:title">
	<meta data-n-head="true" content="https://andreyglauzer.com" data-hid="og:url" property="og:url">
	<meta data-n-head="true" content="https://andreyglauzer.com/img/screen/social.jpg" data-hid="og:image" property="og:image">
	<meta data-n-head="true" content="Andrey Glauzer | Analista de Suporte / Analista de Segurança da Informação em Barueri/SP" name="description" data-hid="description">
	<meta data-n-head="true" content="barueri,são paulo,analista de suporte,analista de segurança da informação,andrey,glauzer" name="keyword" data-hid="keyword">
	<meta data-n-head="true" content="Andrey Glauzer | Analista de Suporte / Analista de Segurança da Informação em Barueri/SP" name="twitter:title" data-hid="twitter:title">
	<meta data-n-head="true" content="Andrey Glauzer | Analista de Suporte / Analista de Segurança da Informação em Barueri/SP" name="twitter:description" data-hid="twitter:description">
	<meta data-n-head="true" content="https://andreyglauzer.com/img/screen/social.jpg" name="twitter:image" data-hid="twitter:image">
	<meta data-n-head="true" content="Andrey Glauzer | Analista de Suporte / Analista de Segurança da Informação em Barueri/SP" name="twitter:image:alt" data-hid="twitter:image:alt">
	<meta data-n-head="true" data-hid="canonical" href="https://andreyglauzer.com" rel="canonical">
</head>


  <body>
    <div id="wrap">
        <!-- IF para definir o HEADER -->
        
          <header class="header">
   <a href="/" class="header__back nuxt-link-active">
      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left">
         <line x1="20" y1="12" x2="4" y2="12"></line>
         <polyline points="10 18 4 12 10 6"></polyline>
      </svg>
      <span>Ir para Home</span>
   </a>
   <div>
      <nav role="navigation" class="navbar">
         <ul role="menu" class="navbar__nav">
            <li class="navbar__nav-item navbar__nav-item--search">
               <div class="inner search__box">
  <a href="#modal" role="link" class="navbar__nav-link">
    <svg  xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="#ffffff">
      <title class="search-icon">Search icon</title>
      <path  fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path>
    </svg>
  </a>
</div>
<div class="modal" id="modal">
  <div class="search__box">
    <a class="modal--close" href="#">&times;</a>
      <svg data-v-38ac2332="" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="#404756" class="search__icon"><title data-v-38ac2332="" id="searchicon">Search icon</title><path data-v-38ac2332="" fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path></svg>
      <input type="text" id="search-input" class="search__input" placeholder="Digite algo..." autofocus>

      <ul id="results-container"></ul>
  </div>
</div>
<script src="/js/simple-jekyll-search.min.js"></script>
<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('results-container'),
  json: '/search.json'
})
</script>
            </li>
            <li role="menuitem" class="navbar__nav-item">
            	<a href="/" class="navbar__nav-link" title="Sobre" role="link">Home</a>
            </li>
            <li role="menuitem" class="navbar__nav-item">
               <a href="/projetos" class="navbar__nav-link" title="Projetos" role="link">Projetos</a>
            </li>
            <li role="menuitem" class="navbar__nav-item">
               <a href="/colecoes" class="navbar__nav-link" title="Projetos" role="link">Coleções</a>
            </li>
            <!-- FOR para gerar os intens do menu. -->
            
			    
			 
			    
			    <li role="menuitem" class="navbar__nav-item">
			    	<a role="link" class="navbar__nav-link" href="/about" title="Sobre">Sobre</a>
			    </li>
			    
			 
			    
			 
			    
			 
			    
			 
			    
			 
			    
			 
			    
			 
			    
			 
			    
			 
			    
			 
			    
			 
			    
			 
         </ul>
      </nav>
      <!---->
   </div>
</header>


<a class="menu__mobile" id="nav-menu">
    <div id="menu"></div>
</a>
<nav id="nav">
    <div id="nav-list">
        <a href="/">Home</a>
        <a href="/projetos" title="Projetos" role="link">Projetos</a>
        
            
        
            
            <a href="/about" title="Sobre">Sobre</a>
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
    </div>
</nav>
<header id="header" class="pageHeader pageHeader--background">
	<article itemscope="itemscope" itemtype="http://schema.org/NewsArticle" class="article">
		<figure itemprop="image" itemscope="itemscope" itemtype="http://schema.org/ImageObject" class="pageHeader__image">
			<meta itemprop="url" content="/img/posts/2017-07-14-automatizando-tarefas-diarias-com-python/banner.png">
			<img src="/img/posts/2017-07-14-automatizando-tarefas-diarias-com-python/banner.png" alt="Automatizando tarefas diarias com python" />
		</figure>
		<div class="info-header">
			<h1 class="pageHeader__title">Automatizando tarefas diarias com python</h1>
			<ol itemscope="itemscope" itemtype="http://schema.org/BreadcrumbList" class="breadcrumb">
				<li itemprop="itemListElement" itemscope="itemscope" itemtype="http://schema.org/ListItem" class="breadcrumb__item">
					<a  href="/" class="breadcrumb__link nuxt-link-active" title="Home" itemprop="item">
						<span itemprop="name">Home</span>
						<meta  itemprop="position" content="1">
					</a>
					<span class="breadcrumb__divider">»</span>
				</li>
				
				<li itemprop="itemListElement" itemscope="itemscope" itemtype="http://schema.org/ListItem" class="breadcrumb__item">
					<a class="breadcrumb__link nuxt-link-exact-active nuxt-link-active breadcrumb__link--active" title="Automatizando tarefas diarias com python" itemprop="item" href="/automatizando-tarefas-diarias-com-python">
					<span itemprop="name">Automatizando tarefas diarias com python</span>
					<meta itemprop="position" content="2">
					</a>
				</li>

			</ol>
			<p itemprop="description" class="pageHeader__description">Script bem simples que eu desenvolvi, para bater o ponto no meu trabalho.</p>
			<div class="pageHeader__meta">

				<span>Publicado em Julho de 2017 por <span itemprop="author">Andrey Glauzer</span>
			</div>
		</div>
	</span>
</header>

        

        <!-- Main content -->
    	  <div class="container">
          <div class="grid grid--1of2">
        			<article id="post-page">
	<div class="content">
		<h3 id="como-usar-o-pontopy">Como usar o ponto.py</h3>

<p>Esse script eu criei pensando em um ambiente Windows, já que no meu trabalho eu uso windows como sistema operacional padrão, e eu sempre acabo me esquecendo, ou as vezes eu tenho preguiça de bater o ponto, então resolvi criar um script para facilitar as coisas.</p>

<p><img src="img/posts/2017-07-14-automatizando-tarefas-diarias-com-python/banner.png" alt="Banner" /></p>

<p>Primeiro você vai precisar instalar o Python em seu computador e também o Pip, a baixo tem o link de como você pode fazer download e as instruções de instalação.</p>

<p>Python - <a href="https://www.python.org/downloads/" class="link-exteno">https://www.python.org/downloads/</a></p>

<p>Pip - <a href="https://pip.pypa.io/en/stable/installing/" class="link-exteno">https://pip.pypa.io/en/stable/installing/</a></p>

<p>Com os dois instalados na sua máquina, vamos para a ação. Tentei deixar o mais simples possível, fazendo um screenshot simples da tela e me enviando por e-mail o comprovante do ponto, só para ter guardado comigo.</p>

<p>Dentro da pasta <code class="highlighter-rouge">includes</code> é possível localizar um arquivo chamado <code class="highlighter-rouge">requirements.txt</code></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">pyscreenshot</span><span class="o">==</span><span class="mf">0.4</span>
<span class="n">selenium</span><span class="o">==</span><span class="mf">2.49</span><span class="o">.</span><span class="mi">0</span>
<span class="n">PyYAML</span><span class="o">==</span><span class="mf">3.11</span>
<span class="n">time</span>
<span class="n">yaml</span>
<span class="n">image</span></code></pre></figure>

<p>Você precisa instalar todos os requerimentos para o script funcionar, então você pode fazer o seguinte.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">cd</span> <span class="n">includes</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span></code></pre></figure>

<p>Após instalação dos requerimentos, vamos ao script. Aqui eu faço a importação de tudo que eu vou usar nele, como email, printscreen etc..</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="kn">from</span> <span class="nn">email</span> <span class="kn">import</span> <span class="n">encoders</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">os</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">smtplib</span><span class="p">,</span> <span class="n">yaml</span>
<span class="kn">import</span> <span class="nn">pyscreenshot</span> <span class="k">as</span> <span class="n">ImageGrab</span>
<span class="kn">from</span> <span class="nn">email.MIMEText</span> <span class="kn">import</span> <span class="n">MIMEText</span>
<span class="kn">from</span> <span class="nn">email.MIMEBase</span> <span class="kn">import</span> <span class="n">MIMEBase</span>
<span class="kn">from</span> <span class="nn">email.MIMEMultipart</span> <span class="kn">import</span> <span class="n">MIMEMultipart</span></code></pre></figure>

<p>Aqui eu tenho um HELP, onde eu explico como utilizar o script, então se você executar o script sem argumentos você será direcionado para ele, ou se você usar <code class="highlighter-rouge">python3 ponto.py -h</code>, deve aparecer o help.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">MEAJUDA</span> <span class="o">=</span> <span class="p">(</span><span class="s">"""

Ponto v 2.0 ( Andrey Glauzer - https://andreyglauzer.com )

Use: python ponto.py [Entrada/Saída] &lt;Usuário&gt; &lt;Senha&gt;
Ex: python ponto.py -e andrey 123456

-e  : Especifica que você quer bater a sua entrada no ponto.
-s  : Especifica que você quer bater a sua sáida no ponto.

"""</span><span class="p">)</span></code></pre></figure>

<p>Dentro da pasta <code class="highlighter-rouge">includes</code> também existe um arquivo chamado <code class="highlighter-rouge">config.yml</code>, que é onde você vai colocar as informações necessárias para o script funcionar, então aqui eu estou chamando o <code class="highlighter-rouge">config.yml</code> e pegando as informações das variáveis que estão lá.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">cur_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span>
<span class="n">config_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cur_dir</span><span class="p">,</span> <span class="s">'includes/config.yml'</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">stream</span><span class="p">:</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
<span class="n">PATHDRIVER</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'chomedriver'</span><span class="p">,</span><span class="s">''</span><span class="p">)</span>
<span class="n">SENHAMAIL</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'senhadoemail'</span><span class="p">)</span>
<span class="n">EMAIL</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'meuemail'</span><span class="p">)</span>
<span class="n">DESTINATARIO</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'quemrecebe'</span><span class="p">)</span>
<span class="n">SMTP</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'smtpserver'</span><span class="p">)</span></code></pre></figure>

<p>Nessa parte do script estou definindo os meus argumentos, para que eu possa armazenar eles em uma variável, e poder utiliza-los ao decorrer co script.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">get_argumentos</span><span class="p">():</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="ow">is</span> <span class="mi">4</span><span class="p">:</span>
<span class="k">return</span> <span class="p">{</span>
<span class="s">'tipo'</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="s">'user_info'</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="s">'user_passwd'</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span class="p">}</span>
<span class="k">else</span><span class="p">:</span>
<span class="k">print</span><span class="p">(</span><span class="n">MEAJUDA</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span></code></pre></figure>

<p>No site para barter o ponto existe um select, que é necessário selecionar se vou bater a entrada/saida, então para isso que eu uso os argumentos -e = Entrada e -s = Saída, que é justamente aqui, que vamos selecionar o que vamos fazer.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">faztudo</span><span class="p">(</span><span class="n">argumento</span><span class="p">):</span>

<span class="k">print</span> <span class="p">(</span><span class="s">"[+] - Selecionando a opção desejada..."</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="s">'{0}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">argumento</span><span class="p">[</span><span class="s">'tipo'</span><span class="p">]))</span> <span class="o">==</span> <span class="s">'-e'</span><span class="p">:</span>
<span class="n">xpathselect</span> <span class="o">=</span> <span class="s">'//*[@id="form1"]/table/tbody/tr[7]/td[2]/font/select/option[2]'</span>
<span class="k">elif</span> <span class="p">(</span><span class="s">'{0}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">argumento</span><span class="p">[</span><span class="s">'tipo'</span><span class="p">]))</span> <span class="o">==</span> <span class="s">'-s'</span><span class="p">:</span>
<span class="n">xpathselect</span> <span class="o">=</span> <span class="s">'//*[@id="form1"]/table/tbody/tr[7]/td[2]/font/select/option[3]'</span>
<span class="k">elif</span> <span class="p">(</span><span class="s">'{0}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">argumento</span><span class="p">[</span><span class="s">'tipo'</span><span class="p">]))</span> <span class="o">==</span> <span class="s">'-h'</span><span class="p">:</span>
<span class="k">print</span> <span class="p">(</span><span class="n">MEAJUDA</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
<span class="k">print</span> <span class="p">(</span><span class="n">MEAJUDA</span><span class="p">)</span></code></pre></figure>

<p>Já aqui entra toda a parte de navegação do browser que no caso eu estou usando o Chrome, então ele entra no site, coloca meu usuário e minha senha, nos campos que eu indiquei de acordo com o nome do input, clica na opção <code class="highlighter-rouge">continuar</code>, seleciona Entrada/Saída de acordo com a opção que eu selecionei no menu, e depois clica em <code class="highlighter-rouge">confirmar</code>.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">print</span> <span class="p">(</span><span class="s">"[+] - Abrindo o Chrome..."</span><span class="p">)</span>
<span class="n">options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ChromeOptions</span><span class="p">()</span>
<span class="n">localdochromedriver</span> <span class="o">=</span> <span class="n">PATHDRIVER</span>
<span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"user-data-dir=etc</span><span class="err">\</span><span class="s">perfil_chrome"</span><span class="p">)</span>
<span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="n">localdochromedriver</span><span class="p">,</span> <span class="n">chrome_options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
<span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"http://sac.bind.com.br/ponto/"</span><span class="p">)</span>
<span class="c">#driver.maximize_window()</span>
<span class="k">print</span> <span class="p">(</span><span class="s">"[+] - Aplicando o seu usuário e senha..."</span><span class="p">)</span>
<span class="n">email</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s">"nome"</span><span class="p">)</span>
<span class="n">email</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s">'{0}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">argumento</span><span class="p">[</span><span class="s">'user_info'</span><span class="p">]))</span>
<span class="n">senha</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s">"id"</span><span class="p">)</span>
<span class="n">senha</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s">'{0}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">argumento</span><span class="p">[</span><span class="s">'user_passwd'</span><span class="p">]))</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s">'continuar'</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
<span class="k">print</span> <span class="p">(</span><span class="s">"[+] - Batendo o seu ponto..."</span><span class="p">)</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">xpathselect</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s">'confirmar'</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span></code></pre></figure>

<p>Aqui eu solicito que ele aguarde um tempo para que a página carregue e o printscreen seje feito no momento exato.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span></code></pre></figure>

<p>E então já nessa parte do script eu tiro o screenshot da tela e a salvo em <code class="highlighter-rouge">includes/screenshots/</code></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">print</span> <span class="p">(</span><span class="s">"[+] - Tirando uma screenshot do seu ponto..."</span><span class="p">)</span>
<span class="n">date</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">"</span><span class="si">%</span><span class="s">Y-</span><span class="si">%</span><span class="s">m-</span><span class="si">%</span><span class="s">d"</span><span class="p">))</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ImageGrab</span><span class="o">.</span><span class="n">grab</span><span class="p">()</span>
<span class="n">img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">"includes/screenshots/{0}_meuponto_{1}.jpg"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">USERNAME</span><span class="p">))</span>
<span class="n">envemail</span><span class="p">(</span><span class="n">driver</span><span class="p">)</span></code></pre></figure>

<p>E por fim, entra toda a parte do script que envia o email, de acordo com as informações que você colocou no <code class="highlighter-rouge">config.yml</code>, anexando o printscreen, que é o nosso comprovante de ponto.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">envemail</span><span class="p">(</span><span class="n">driver</span><span class="p">):</span>
<span class="k">print</span> <span class="p">(</span><span class="s">"[+] - Localizando o seu print..."</span><span class="p">)</span>
<span class="n">imgpatch</span> <span class="o">=</span> <span class="p">(</span><span class="s">"includes/screenshots/{0}_meuponto_{1}.jpg"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">USERNAME</span><span class="p">))</span>
<span class="k">print</span> <span class="p">(</span><span class="s">"[+] - Organizando o email p/ ser enviado..."</span><span class="p">)</span>
<span class="n">msg</span> <span class="o">=</span> <span class="n">MIMEMultipart</span><span class="p">()</span>
<span class="n">msg</span><span class="p">[</span><span class="s">'From'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">EMAIL</span><span class="p">)</span>
<span class="n">msg</span><span class="p">[</span><span class="s">'To'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">DESTINATARIO</span><span class="p">)</span>
<span class="n">msg</span><span class="p">[</span><span class="s">'Subject'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'Meu ponto do dia </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">date</span>
<span class="n">body</span> <span class="o">=</span> <span class="s">'''
=================================================================

NOME DA IMAGEM DO PONTO :</span><span class="si">%</span><span class="s">s

PONTO DO DIA:</span><span class="si">%</span><span class="s">s

=================================================================
'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">imgpatch</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>

<span class="n">msg</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">MIMEText</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="s">'plain'</span><span class="p">))</span>
<span class="n">filename</span> <span class="o">=</span> <span class="p">(</span><span class="n">imgpatch</span><span class="p">)</span>
<span class="n">attachment</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">imgpatch</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">)</span>
<span class="n">part</span> <span class="o">=</span> <span class="n">MIMEBase</span><span class="p">(</span><span class="s">'application'</span><span class="p">,</span> <span class="s">'octet-stream'</span><span class="p">)</span>
<span class="n">part</span><span class="o">.</span><span class="n">set_payload</span><span class="p">((</span><span class="n">attachment</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="n">encoders</span><span class="o">.</span><span class="n">encode_base64</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
<span class="n">part</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'Content-Disposition'</span><span class="p">,</span> <span class="s">"attachment; filename= </span><span class="si">%</span><span class="s">s"</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
<span class="n">msg</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">smtplib</span><span class="o">.</span><span class="n">SMTP</span><span class="p">(</span><span class="n">SMTP</span><span class="p">,</span> <span class="mi">587</span><span class="p">)</span>
<span class="n">server</span><span class="o">.</span><span class="n">starttls</span><span class="p">()</span>
<span class="k">print</span> <span class="p">(</span><span class="s">"[+] - Enviando o seu email..."</span><span class="p">)</span>
<span class="n">server</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">EMAIL</span><span class="p">,</span> <span class="n">SENHAMAIL</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
<span class="n">server</span><span class="o">.</span><span class="n">sendmail</span><span class="p">(</span><span class="n">EMAIL</span><span class="p">,</span> <span class="n">DESTINATARIO</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">"[+] - E-mail enviado com sucesso!"</span><span class="p">)</span></code></pre></figure>

<p>Enquanto o scritp é executado você consegue ver o que está sendo feito, como o log à baixo:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">andrey</span>\<span class="n">Documents</span>\<span class="n">GitHub</span>\<span class="n">ponto</span><span class="o">&gt;</span> <span class="n">python</span> <span class="o">.</span>\<span class="n">ponto</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">e</span> <span class="n">usuarioteste</span> <span class="n">senhateste</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="o">-</span> <span class="n">Selecionando</span> <span class="n">a</span> <span class="n">op</span><span class="err">çã</span><span class="n">o</span> <span class="n">desejada</span><span class="o">...</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="o">-</span> <span class="n">Abrindo</span> <span class="n">o</span> <span class="n">Chrome</span><span class="o">...</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="o">-</span> <span class="n">Aplicando</span> <span class="n">o</span> <span class="n">seu</span> <span class="n">usu</span><span class="err">á</span><span class="n">rio</span> <span class="n">e</span> <span class="n">senha</span><span class="o">...</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="o">-</span> <span class="n">Batendo</span> <span class="n">o</span> <span class="n">seu</span> <span class="n">ponto</span><span class="o">...</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="o">-</span> <span class="n">Localizando</span> <span class="n">o</span> <span class="n">seu</span> <span class="k">print</span><span class="o">...</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="o">-</span> <span class="n">Organizando</span> <span class="n">o</span> <span class="n">email</span> <span class="n">p</span><span class="o">/</span> <span class="n">ser</span> <span class="n">enviado</span><span class="o">...</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="o">-</span> <span class="n">Enviando</span> <span class="n">o</span> <span class="n">seu</span> <span class="n">email</span><span class="o">...</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="o">-</span> <span class="n">E</span><span class="o">-</span><span class="n">mail</span> <span class="n">enviado</span> <span class="n">com</span> <span class="n">sucesso</span><span class="err">!</span></code></pre></figure>

<p>Por fim é isso, não tive problema usando ele no Windows 10!</p>

		<div id="coment" class="comments">
	<div class="content-coment">
		<h3 data-v-dd8644c2="">Comentários para: <span class="opacity">"Automatizando tarefas diarias com python"</span></h3>
		<div id="disqus_thread"></div>
		<script>

		/**
		 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
		 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
		/*
		var disqus_config = function () {
		    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
		    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
		};
		*/
		(function() { // DON'T EDIT BELOW THIS LINE
		    var d = document, s = d.createElement('script');
		    s.src = '//andreyglauzer-1.disqus.com/embed.js';
		    s.setAttribute('data-timestamp', +new Date());
		    (d.head || d.body).appendChild(s);
		})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                                    
	</div>
</div>

<style type="text/css">

.comments{
    background-color: #fff;
    border-top: 1.12px solid rgba(64,71,86,.1);
    border-top: .07rem solid rgba(64,71,86,.1);
    padding: 30px 0 0;
    padding: 1.875rem 0 0;
    margin-top: 30px;
    margin-top: 1.875rem;

div.alinhamento-header-posts{
    padding-top: 3rem;
}

div#coment{
    background-color: #fff;
    padding: 30px 0;
    margin-top: 15px;
}
div.content-coment h3 span.opacity{
        opacity: .6;
    font-weight: 500;
}
div.content-coment{
    max-width: 768px;
    max-width: 48rem;
    display: block;
    margin:0 auto;
}
</style>
	</div>
</article>


          </div>
    		
    		  <!-- Definicação de paginação -->
          

    	  </div>
    	    
    	    <!-- Footer -->
    	    <footer>
	Made with ♥ by <a target="_blank" href="https:/github.com/andreyglauzer/">Andrey Glauzer</a>, using <a href="">Jekyll</a>. This is an open <a target="_blank" href="https:/github.com/andreyglauzer/andreyglauzer.github.io/">source code</a>. Version 1.1.0.
</footer>

	<!-- Analise -->

	<!-- Quantcast Tag -->
	<script type="text/javascript">
	var _qevents = _qevents || [];

	(function() {
	var elem = document.createElement('script');
	elem.src = (document.location.protocol == "https:" ? "https://secure" : "http://edge") + ".quantserve.com/quant.js";
	elem.async = true;
	elem.type = "text/javascript";
	var scpt = document.getElementsByTagName('script')[0];
	scpt.parentNode.insertBefore(elem, scpt);
	})();

	_qevents.push({
	qacct:"p-BTQDD6C697r5P"
	});
	</script>

	<noscript>
	<div style="display:none;">
	<img src="//pixel.quantserve.com/pixel/p-BTQDD6C697r5P.gif" border="0" height="1" width="1" alt="Quantcast"/>
	</div>
	</noscript>
	<!-- End Quantcast tag -->

    	    <!-- Script -->
          <script src="/js/main.js"></script>	

  	</div>
  </body>
</html>